<html>
<head>
<!-- Load the d3 library. -->
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<style>
body { font-family: "Open Sans"; }
svg { border: solid black 1px; margin: 10px; }
</style>
</head>

<body>

<div id="histogram1"></div>
<script>
var teens = {};
var adults;

var width = 500,
    height = 500,
    padding = 20;

var svg = d3.select("#histogram1").append("svg")
	.attr("width", width)
	.attr("height", height)
	.attr("id", "hist1");

// Splits the string into properly spelled, capitalized sites
var sanitizeSites = function (s) {
	var sites = [];
	return s.toUpperCase();
};

// Load the data for online dating for teens
d3.csv("teen_dating.csv", function(error, teenIds) {
	teenIds
	.forEach(function (teen) {
		teens[teen.CaseID] = {
			useOnlineDating: null,
			site: teen.REL3 ? sanitizeSites(teen.REL3) : [],
			acceptableBreakup: {
				text: teen.KR10_1,
				inPerson: teen.KR10_2,
				onlineMessage: teen.KR10_4,
				statusChange: teen.KR10_6
			},
			yourBreakupMethod: {
				inPerson: teen.KR11_B == 1,
				textEmailOnline: teen.KR11_C == 1 || teen.KR11_D == 1 || teen.KR11_E == 1,
				statusChange: teen.KR11_F == 1,
				postStatus: teen.KR11_G == 1,
				postImage: teen.KR11_H == 1
			},
			theirBreakupMethod: {
				inPerson: teen.KR12_B == 1,
				textEmailOnline: teen.KR12_C == 1 || teen.KR12_D == 1 || teen.KR12_E == 1,
				statusChange: teen.KR12_F == 1,
				postStatus: teen.KR12_G == 1,
				postImage: teen.KR12_H == 1
			},
			unsocialEx: teen.KRSNS4_A == 1 || teen.KRSNS4_C == 1
		};
		if (teen.KR1 == 2 || teen.KR1 == 3 || teen.KR1 == 4) {
			teens[teen.CaseID].useOnlineDating = true;
		} else {
			teens[teen.CaseID].useOnlineDating = false;
		}
	}); 
});

d3.csv("adult_dating.csv", function (error, data){
	adults=data.filter(function (d){
		return{
			blocked: d.snsdate2a,
			untagged: d.snsdate2c,
			breakup: d.breaka,
			brokenup: d.breakb,
			usedDatingSite: d.date1a,
			match: d.date1bm1,
			eharmony:d.date1bm2,
			okcupid: d.date1bm3,
			plentyOfFish: d.date1bm4,
			christianMingle: d.date1bm5,
			true: d.date1bm6,
			zoosk:d.date1bm7,
			jdate:d.date1bm8,
			dateHookup:d.date1bm9,
			ashleyMadison:d.date1bm10,
			facebook:d.date1bm11,
			twitter:d.date1bm12,
			adultFriendFinder:d.date1bm13,
			blackplanet:d.date1bm14,
			chemistry:d.date1bm15,
			craigslist:d.date1bm16,
			other:d.date1bm17,
			goneOnDate:d.date5a,
			longTermRelationship:d.date5b,
			beenContacted:d.date5c,
			misrepresentedThemselves:d.date5d,
			helpCreateProfile:d.date5e,
			alreadyKnewMatch:d.date5f,
			goodWayToMeet:d.date9a,
			findBetterMatch:d.date9b,
			desperate:d.date9c,
			alwaysHaveNewOptions:d.date9d
		};
	});
});

</script>
</body>

</html>