<html>
<head>
<script charset="utf-8" src="http://d3js.org/d3.v3.min.js"></script>
<link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700' rel='stylesheet' type='text/css'>
<style>
body { font-family: 'Open Sans Condensed', 'sans-serif'; }
svg { border: solid black 1px; }
hearts {font-size: 20px; fill: "red";}
button { padding: 15px; margin: 10px;
	font-family: 'Open Sans Condensed', 'sans-serif';
	font-weight:700;
	width: 120;
	color: white;
	background-color: #ff4d4d;
	text-transform: uppercase;
	letter-spacing: 2px;
	padding: 10px 30px;
	border-radius: 5px;
	font-size: 16px;
	border: solid red 1px;}
		.axis path { fill: none; stroke: #aaa;}
	.axis line { stroke: #aaa; }
	.axis text { fill: #aaa; font-size: .7em; }
rect.bar { fill: #cc0000;; }
text.label {
	fill: #888;
	font-size: x-small;
	dominant-baseline: middle; 
	text-anchor: middle;

}
</style>
</head>

<body>
	<h1>Online Dating</h1>
	<p>Instructions: Select either 'Teens' or 'Adults' to learn about statistics involving the selected group and online dating habits </p>
	<div>
	<button id="home">Home</button>
	<button id="teens" class="tButton tSelect">Teens</button>
	<button id= "adults" class= "aButton aSelect">Adults</button>
</div>
	<div id="p2" style="display: inline-block; float: left"></div>
	<div style="display: inline-block; vertical-align: top; position: relative" >
		<div id="samp" style="position: absolute"></div>
		<div id="samp2" style="position: absolute"></div>
		<div id="samp3" style="position: absolute"></div>
		<div id="samp4" style="position: absolute"></div>
	</div>

<div id="histogram1"></div>
<script>
	d3.select("#samp").style("visibility", "hidden");
	d3.select("#samp2").style("visibility", "hidden");
	d3.select("#samp3").style("visibility", "hidden");
	d3.select("#samp4").style("visibility", "hidden");
	var height = 300;
	var width = 300;
	var heart = String.fromCharCode(10084);
	var brokenHeart = '\uD83D\uDC94';
	var svg = d3.select("#p2").append("svg").attr("height", height).attr("width", width);
	svg.append("text").html(heart).attr("x", 30).attr("y", 200).style("font-size", "100px" ).style("fill", "red" ).attr("id", "teenHeart").style("visibility", "hidden");
	svg.append("text").html(brokenHeart).attr("x", 30).attr("y", 200).style("font-size", "100px" ).style("fill", "red" ).attr("id", "teenBrokenHeart").style("visibility", "hidden");
	svg.append("text").text(" " +heart).attr("x", 30).attr("y", 200).style("font-size", "100px" ).style("fill", "red" ).attr("id", "adultHeart").style("visibility", "hidden");
	svg.append("text").text(" " + brokenHeart).attr("x", 30).attr("y", 200).style("font-size", "100px" ).style("fill", "red" ).attr("id", "adultBrokenHeart").style("visibility", "hidden");


	var teenHeart = d3.select("#teenHeart");
	var teenBrokenHeart = d3.select("#teenBrokenHeart");
	var adultHeart = d3.select("#adultHeart");
	var adultBrokenHeart = d3.select("#adultBrokenHeart");

	d3.select("#teens").on("click", function() {
		teenHeart.style("visibility", "visible");
		teenBrokenHeart.style("opacity", "hidden");
		adultHeart.style("visibility", "hidden");
		adultBrokenHeart.style("visibility", "hidden");
		d3.select("#samp").style("visibility", "hidden");
			d3.select("#samp2").style("visibility", "hidden");
		d3.select("#samp3").style("visibility", "hidden");
		d3.select("#samp4").style("visibility", "hidden");
	});

	d3.select("#teenHeart").on("click", function() {;
		teenHeart.style("visibility", "hidden");
			d3.select("#teenBrokenHeart").style("visibility", "visible");
			d3.select("#samp").style("visibility", "visible");
			d3.select("#samp2").style("visibility", "hidden");
		d3.select("#samp3").style("visibility", "hidden");
		d3.select("#samp4").style("visibility", "hidden");
	});
	d3.select("#teenBrokenHeart").on("click", function() {;
		teenHeart.style("visibility", "visible");
		teenBrokenHeart.style("visibility", "hidden");
		d3.select("#samp").style("visibility", "hidden");
		d3.select("#samp2").style("visibility", "visible");
		d3.select("#samp3").style("visibility", "hidden");
		d3.select("#samp4").style("visibility", "hidden");
	});

	d3.select("#adults").on("click", function() {
		teenHeart.style("visibility", "hidden");
		teenBrokenHeart.style("opacity", "hidden");
		adultHeart.style("visibility", "visible");
		adultBrokenHeart.style("visibility", "hidden");
		d3.select("#samp").style("visibility", "hidden");
		d3.select("#samp2").style("visibility", "hidden");
		d3.select("#samp3").style("visibility", "hidden");
		d3.select("#samp4").style("visibility", "hidden");

	});
	d3.select("#adultHeart").on("click", function() {;
			adultHeart.style("visibility", "hidden");
			adultBrokenHeart.style("visibility", "visible");
			d3.select("#samp").style("visibility", "hidden");
		d3.select("#samp2").style("visibility", "hidden");
		d3.select("#samp3").style("visibility", "hidden");
		d3.select("#samp4").style("visibility", "visible");
	});
	d3.select("#adultBrokenHeart").on("click", function() {;
		adultHeart.style("visibility", "visible");
		adultBrokenHeart.style("visibility", "hidden");
		d3.select("#samp").style("visibility", "hidden");
		d3.select("#samp2").style("visibility", "hidden");
		d3.select("#samp3").style("visibility", "visible");
		d3.select("#samp4").style("visibility", "hidden");
	});


	function plotHistogram(strID, myG) {
		console.log("here");
		//x-axis variables
		var myMax = d3.max(myG);
		var myMin = d3.min(myG);

		var binCounter = d3.layout.histogram().bins(10).range([myMin, myMax]); //y axis
		var uniformBins = binCounter(myG);
	
		var bins = uniformBins;
			
		height = 300;
		width = 400;
		padding = 50;
		var svg = d3.select(strID).append("svg")
		.attr("height", height).attr("width", width);

		var xBands = d3.scale.ordinal()
			.domain(bins.map(function (bin) {
			 	return bin.x;
		 	}))
			.rangeBands([padding, width-padding], 0.1);
		
		var xScale = d3.scale.ordinal().domain(bins.map(function (bin) {
            	return d3.round(bin.x, 2);
            }))
		.rangeBands([padding, width-padding], 0.1);
		
		var yScale = d3.scale.linear()
			.domain([0, d3.max(bins, function(bin) {return bin.y; })])
			.range([height - padding, padding]);

		bins.forEach(function (bin) {
			svg.append("rect").attr("class", "bar")
			.attr("x", xBands(bin.x))
			.attr("y", yScale(bin.y))
			.attr("width", xBands.rangeBand())
			.attr("height", (yScale(0) - yScale(bin.y)));
		});

		var yAxis = d3.svg.axis().scale(yScale)
		.orient("left");

		var xAxis = d3.svg.axis().scale(xScale).orient("bottom");

		svg.append("g").attr("transform", "translate(0," + (height - padding) + ")").attr("class", "axis").call(xAxis);		

		svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis").call(yAxis);
	}
	var sample = [3, 4, 5, 3, 7, 3, 5, 7, 3, 1, 4,5];
	var sample2 = [1, 1, 1, 1, 1, 3];
	var sample3 = [3, 4, 6, 3, 5, 6];
	var sample4 = [1, 2, 2, 3, 3, 3, 4, 4, 4, 4];
	plotHistogram("#samp", sample);
	plotHistogram("#samp2", sample2);
	plotHistogram("#samp3", sample3);
	plotHistogram("#samp4", sample4);
</script>
<script>
var teens = {};
var adults;

var width = 500,
    height = 500,
    padding = 20;

var svg = d3.select("#histogram1").append("svg")
	.attr("width", width)
	.attr("height", height)
	.attr("id", "hist1");

// Splits the string into properly spelled, capitalized sites
var sanitizeSites = function (s) {
	var sites = [];
	return s.toUpperCase();
};

// Load the data for online dating for teens
d3.csv("teen_dating.csv", function(error, teenIds) {
	teenIds
	.forEach(function (teen) {
		teens[teen.CaseID] = {
			useOnlineDating: null,
			site: teen.REL3 ? sanitizeSites(teen.REL3) : [],
			acceptableBreakup: {
				text: teen.KR10_1,
				inPerson: teen.KR10_2,
				onlineMessage: teen.KR10_4,
				statusChange: teen.KR10_6
			},
			yourBreakupMethod: {
				inPerson: teen.KR11_B == 1,
				textEmailOnline: teen.KR11_C == 1 || teen.KR11_D == 1 || teen.KR11_E == 1,
				statusChange: teen.KR11_F == 1,
				postStatus: teen.KR11_G == 1,
				postImage: teen.KR11_H == 1
			},
			theirBreakupMethod: {
				inPerson: teen.KR12_B == 1,
				textEmailOnline: teen.KR12_C == 1 || teen.KR12_D == 1 || teen.KR12_E == 1,
				statusChange: teen.KR12_F == 1,
				postStatus: teen.KR12_G == 1,
				postImage: teen.KR12_H == 1
			},
			unsocialEx: teen.KRSNS4_A == 1 || teen.KRSNS4_C == 1
		};
		if (teen.KR1 == 2 || teen.KR1 == 3 || teen.KR1 == 4) {
			teens[teen.CaseID].useOnlineDating = true;
		} else {
			teens[teen.CaseID].useOnlineDating = false;
		}
	}); 
});

d3.csv("adult_dating.csv", function (error, data){
	adults=data.filter(function (d){
		return{
			blocked: d.snsdate2a,
			untagged: d.snsdate2c,
			breakup: d.breaka,
			brokenup: d.breakb,
			usedDatingSite: d.date1a,
			match: d.date1bm1,
			eharmony:d.date1bm2,
			okcupid: d.date1bm3,
			plentyOfFish: d.date1bm4,
			christianMingle: d.date1bm5,
			true: d.date1bm6,
			zoosk:d.date1bm7,
			jdate:d.date1bm8,
			dateHookup:d.date1bm9,
			ashleyMadison:d.date1bm10,
			facebook:d.date1bm11,
			twitter:d.date1bm12,
			adultFriendFinder:d.date1bm13,
			blackplanet:d.date1bm14,
			chemistry:d.date1bm15,
			craigslist:d.date1bm16,
			other:d.date1bm17,
			goneOnDate:d.date5a,
			longTermRelationship:d.date5b,
			beenContacted:d.date5c,
			misrepresentedThemselves:d.date5d,
			helpCreateProfile:d.date5e,
			alreadyKnewMatch:d.date5f,
			goodWayToMeet:d.date9a,
			findBetterMatch:d.date9b,
			desperate:d.date9c,
			alwaysHaveNewOptions:d.date9d
		};
	});
});

</script>
</body>

</html>